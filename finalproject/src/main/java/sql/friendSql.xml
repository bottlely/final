<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="mars.ff">
	<insert id="friendAdd" parameterType="mars.friend.model.FriendDTO">
		insert into mars_ff values(mars_ff_idx.nextval, #{user1_idx}, #{user2_idx}, 0, '', 0, 0, 0, '', '')
	</insert>
	<select id="followingList" parameterType="Integer" resultType="mars.member.model.MemberDTO">
		select mars_member.idx, mars_member.name
		from mars_member, mars_ff
		where mars_member.idx=mars_ff.user2_idx and mars_ff.user1_idx=#{user1_idx}	
	</select>
	<select id="followerList" parameterType="Integer" resultType="mars.member.model.MemberDTO">
		select mars_member.name, mars_member.idx
		from mars_member, mars_ff
		where mars_member.idx=mars_ff.user1_idx and mars_ff.user2_idx=#{user2_idx}	
	</select>
	<select id="blackList" parameterType="Integer" resultType="mars.member.model.MemberDTO">
		select mars_member.name, mars_member.idx
		from mars_member, mars_ff
		where mars_member.idx=mars_ff.user1_idx and mars_ff.user2_idx=#{user2_idx} and black_state='1'	
	</select>
	<select id="resultList" parameterType="hashMap" resultType="mars.member.model.MemberDTO">
		select mars_member.name, mars_member.idx
		from mars_member
		where mars_member.name=#{search_name} and 
		mars_member.idx in (select user2_idx
							from mars_ff
							where mars_ff.user1_idx=#{user_idx})
	</select>
	<delete id="deleteFriend" parameterType="Integer">
		delete mars_ff 
		where user1_idx=#{user1_idx} and user2_idx=#{user2_idx}
	</delete>
</mapper>